<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update Order Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div class="max-w-xl mx-auto my-10 bg-white shadow rounded p-6">
        <h1 class="text-xl font-bold mb-4">Update Status for Order #{{ order.id }}</h1>
        <form method="post">
            {% csrf_token %}
            <label for="status" class="block font-medium mb-2">Order Status</label>
            <select name="status" id="status" class="w-full border rounded px-3 py-2 mb-4">
                {% for value, label in status_choices %}
                    <option value="{{ value }}" {% if value == order.status %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Update</button>
        </form>
        <h2 class="text-lg font-semibold mt-6 mb-2">Products in this Order</h2>
        <table class="min-w-full divide-y divide-gray-200 text-sm">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Product</th>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Product Image</th>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Quantity</th>
                    <th class="px-4 py-2 text-right text-gray-600 font-medium">Unit Price</th>
                    <th class="px-4 py-2 text-right text-gray-600 font-medium">Total</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100 bg-white">
                {% for item in order_items %}
                <tr>
                    <td class="px-4 py-2">{{ item.product.p_name }}</td>
                    <td class="px-4 py-2"><img src="{{item.product.p_image.url}}" class="size-16 object-contain" alt=""></td>
                    <td class="px-4 py-2">{{ item.quantity }}</td>
                    <td class="px-4 py-2 text-right">₹{{ item.price_at_order }}</td>
                    <td class="px-4 py-2 text-right">₹{{ item.get_total_price }}</td>
                </tr>
                {% endfor %}
                <tr>
                    <td colspan="3" class="px-4 py-2 text-right font-semibold">Total:</td>
                    <td class="px-4 py-2 text-right font-bold">₹{{ order.get_total_price }}</td>
                </tr>
            </tbody>
        </table>
        <br>
        <a href="{% url 'admin_dashboard' %}" class="text-blue-600 hover:underline">Back to Dashboard</a>
    </div>
</body>
</html>
