<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update Order Status</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div class="max-w-xl mx-auto my-10 bg-white shadow rounded p-6">
        <div class="flex mb-4 items-center justify-between">
            <h1 class="text-xl font-bold ">Update Status for Order #{{ order.id }}</h1>
            <a href="{% url 'admin_dashboard' %}" class="text-blue-600 hover:underline">Back to Dashboard</a>
        </div>
        <form method="post">
            {% csrf_token %}
            <label for="status" class="block font-medium mb-2">Order Status</label> 
            <select name="status" id="status" class="w-full border rounded px-3 py-2 mb-4">
                {% for value, label in status_choices %}
                    <option value="{{ value }}" {% if value == order.status %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Update</button>
        </form>
        {% if messages %}
                {% for message in messages %}
                    {% if message.tags == 'success' %}
                        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
                           
                    {% elif message.tags == 'warning' %}
                        <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative mb-4" role="alert">
                    {% else %}
                        <div class="bg-gray-100 border border-gray-400 text-gray-700 px-4 py-3 rounded relative mb-4" role="alert">
                    {% endif %}
                        <strong>{{ message }}</strong>
                        <span class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer" onclick="this.parentElement.style.display='none';">
                            &times;
                        </span>
                    </div>
                {% endfor %}
            {% endif %}
        <h2 class="text-lg font-semibold mt-6 mb-2">Products in this Order</h2>
        <table class="min-w-full divide-y divide-gray-200 text-sm">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Product</th>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Product Image</th>
                    <th class="px-4 py-2 text-left text-gray-600 font-medium">Quantity</th>
                    <th class="px-4 py-2 text-right text-gray-600 font-medium">Unit Price</th>
                    <th class="px-4 py-2 text-right text-gray-600 font-medium">Total</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100 bg-white">
                {% for item in order_items %}
                <tr>
                    <td class="px-4 py-2">{{ item.product.p_name }}</td>
                    <td class="px-4 py-2"><img src="{{item.product.p_image.url}}" class="size-16 object-contain" alt=""></td>
                    <td class="px-4 py-2">{{ item.quantity }}</td>
                    <td class="px-4 py-2 text-right">₹{{ item.price_at_order }}</td>
                    <td class="px-4 py-2 text-right">₹{{ item.get_total_price }}</td>
                </tr>
                {% endfor %}
                <tr>
                    <td colspan="3" class="px-4 py-2 text-right font-semibold">Total:</td>
                    <td class="px-4 py-2 text-right font-bold">₹{{ order.get_total_price }}</td>
                </tr>
            </tbody>
        </table>
        
    </div>
</body>
</html>
